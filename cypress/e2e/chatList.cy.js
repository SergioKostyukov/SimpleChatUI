describe('ChatListPage', () => {
  const chatsMock = [
    { id: 1, name: '–ß–∞—Ç 1' },
    { id: 2, name: '–ß–∞—Ç 2' },
  ];

  beforeEach(() => {
    // –í—Å—Ç–∞–≤–ª—è—î–º–æ —Ç–æ–∫–µ–Ω, —â–æ–± –ø—Ä–æ–π—Ç–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é
    window.localStorage.setItem('authToken', 'fake-token-for-testing');

    // –ü–µ—Ä–µ—Ö–æ–ø–ª—é—î–º–æ –∑–∞–ø–∏—Ç –Ω–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —á–∞—Ç—ñ–≤ —ñ –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ –º–æ–∫
    cy.intercept('GET', 'http://127.0.0.1:8000/api/chat/chats/', {
      statusCode: 200,
      body: chatsMock,
    }).as('getChats');
  });

  it('–ü–æ–∫–∞–∑—É—î —Å–ø–∏—Å–æ–∫ —á–∞—Ç—ñ–≤ —ñ –≤—ñ–¥–∫—Ä–∏–≤–∞—î —á–∞—Ç –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø—ñ', () => {
    cy.viewport(1280, 800);
    cy.visit('/chats');

    cy.wait('@getChats');

    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫
    cy.contains('üí¨ –°–ø–∏—Å–æ–∫ —á–∞—Ç—ñ–≤').should('exist');

    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —â–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–æ –¥–≤–∞ —á–∞—Ç–∏
    cy.get('aside ul li').should('have.length', chatsMock.length);

    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —â–æ –ø–µ—Ä—à–∏–π —á–∞—Ç –ø—ñ–¥—Å–≤—ñ—á–µ–Ω–∏–π
    cy.get('aside ul li').first().should('have.class', 'bg-indigo-100');

    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —â–æ –æ—Å–Ω–æ–≤–Ω–∞ —Å–µ–∫—Ü—ñ—è –º—ñ—Å—Ç–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —á–∞—Ç—É (—Ç—É—Ç - –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ)
    cy.get('main').should('exist');

    // –ö–ª—ñ–∫–∞—î–º–æ –ø–æ –¥—Ä—É–≥–æ–º—É —á–∞—Ç—É
    cy.get('aside ul li').eq(1).click();

    // –¢–µ–ø–µ—Ä –¥—Ä—É–≥–∏–π —á–∞—Ç –º–∞—î –±—É—Ç–∏ –ø—ñ–¥—Å–≤—ñ—á–µ–Ω–∏–π
    cy.get('aside ul li').eq(1).should('have.class', 'bg-indigo-100');
  });

  it('–ü–æ–∫–∞–∑—É—î —Å–ø–∏—Å–æ–∫ —á–∞—Ç—ñ–≤ —ñ –≤—ñ–¥–∫—Ä–∏–≤–∞—î —á–∞—Ç –Ω–∞ –º–æ–±—ñ–ª—å–Ω–æ–º—É, –ø–æ—Ç—ñ–º –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –Ω–∞–∑–∞–¥', () => {
    cy.viewport(375, 667);
    cy.visit('/chats');

    cy.wait('@getChats');

    // –ù–∞ –º–æ–±—ñ–ª—å–Ω–æ–º—É —Å–ø–æ—á–∞—Ç–∫—É —î —Å–ø–∏—Å–æ–∫ —á–∞—Ç—ñ–≤
    cy.get('aside').should('exist');
    cy.get('aside ul li').should('have.length', chatsMock.length);

    // –û—Å–Ω–æ–≤–Ω–∏–π —á–∞—Ç –Ω–µ –ø–æ–∫–∞–∑–∞–Ω–∏–π
    cy.get('main').should('not.exist');

    // –ö–ª—ñ–∫ –ø–æ –ø–µ—Ä—à–æ–º—É —á–∞—Ç—É –≤—ñ–¥–∫—Ä–∏–≤–∞—î —á–∞—Ç
    cy.get('aside ul li').first().click();

    cy.get('main').should('exist');
    cy.contains('‚Üê –ù–∞–∑–∞–¥ –¥–æ —Å–ø–∏—Å–∫—É —á–∞—Ç—ñ–≤').should('exist');

    // –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ—Å—å –Ω–∞–∑–∞–¥ –¥–æ —Å–ø–∏—Å–∫—É —á–∞—Ç—ñ–≤
    cy.contains('‚Üê –ù–∞–∑–∞–¥ –¥–æ —Å–ø–∏—Å–∫—É —á–∞—Ç—ñ–≤').click();

    cy.get('aside').should('exist');
    cy.get('main').should('not.exist');
  });
});
